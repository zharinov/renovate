import { StringField } from '../base/string-field';
import type { EmptyConfig } from '../base/types';

const osvVulnerabilitySummaryValues = ['none', 'all', 'unresolved'] as const;

type DependencyDashboardOSVVulnerabilitySummaryConfigKey =
  'dependencyDashboardOSVVulnerabilitySummary';
type DependencyDashboardOSVVulnerabilitySummaryConfigValue =
  (typeof osvVulnerabilitySummaryValues)[number];

export class DependencyDashboardOSVVulnerabilitySummaryField<
  T extends EmptyConfig,
> extends StringField<
  T,
  DependencyDashboardOSVVulnerabilitySummaryConfigKey,
  DependencyDashboardOSVVulnerabilitySummaryConfigValue
> {
  override name = 'dependencyDashboardOSVVulnerabilitySummary' as const;

  override description =
    'Control if the Dependency Dashboard issue lists CVEs supplied by [osv.dev](https://osv.dev).';

  override defaultValue = 'none' as const;

  override allowedValues = [...osvVulnerabilitySummaryValues];
}
