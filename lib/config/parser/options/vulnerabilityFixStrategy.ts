import { StringField } from '../base/string-field';
import type { EmptyConfig } from '../base/types';

const vulnerabilityFixStrategyValues = ['lowest', 'highest'] as const;

type VulnerabilityFixStrategyConfigKey = 'vulnerabilityFixStrategy';
type VulnerabilityFixStrategyConfigValue =
  (typeof vulnerabilityFixStrategyValues)[number];

export class VulnerabilityFixStrategyField<
  T extends EmptyConfig,
> extends StringField<
  T,
  VulnerabilityFixStrategyConfigKey,
  VulnerabilityFixStrategyConfigValue
> {
  override name = 'vulnerabilityFixStrategy' as const;

  override description =
    'Strategy to use when fixing vulnerabilities. `lowest` will propose the earliest version with a fix, `highest` will always pick the latest version.';

  override defaultValue = 'lowest' as const;

  override allowedValues = [...vulnerabilityFixStrategyValues];
}
